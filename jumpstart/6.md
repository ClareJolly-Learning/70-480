# Module 6 - JavaScript Advanced Topics <!-- omit in toc -->

- [Exception Handling](#Exception-Handling)
  - [try - catch - finally](#try---catch---finally)
  - [Throw](#Throw)
- [Promises](#Promises)
  - [Syntax](#Syntax)
  - [Demo 1](#Demo-1)
  - [Demo 2 - uses](#Demo-2---uses)
  - [Reporting progress](#Reporting-progress)
- [Web worker](#Web-worker)
- [Web sockets](#Web-sockets)
- [Architecture Patterns](#Architecture-Patterns)
- [TypeScript](#TypeScript)
- [Example questions](#Example-questions)

---

## Exception Handling

- Managing failure in code
- Minimising failures in code

### try - catch - finally

For trying something that could potentially cause a problem.  API call, network call.

Something that would throw a runtime error rather than a syntax error.  Will it succeed in connecting for example

```js
try {
  // line(s) of suspicious code
} catch (err) {
  // .description
  // .message
  // .name
  // .number
  // .stack
} finally {
  // success or failure, code executes here
}
```

`try` the code
`catch` the `err` (use any name here) and can access the listed properties of the error
`finally` run the code.

---

### Throw

```js
function throwHelper() {
  var err = new Error(123, "Error in helper");
  throw err;
}

// elsewhere in code
try {
  throwHelper();
} catch (ex) {
  var msg = ex.number + ": " + ex:message;
  // log msg
}
```

Demo

```js
function isTypeOf(o, t) {
  if (t && t.charAt && t.charAt(0)) {
    return (Object.prototype.toString.call(o) === "[object " + t + "]");
  } else {
    throw new Error(123, "Error in helper")
    // throw new Error ("Args", "'t' required and must be a string.");
  }
}

console.log(isTypeOf({test: 'test'},'Object'))  // true
console.log(isTypeOf({test: 'test'},999)) //

```

---

## Promises

If there's a possibility that a function may take more that 50 ms then this is an async function. And must be called as such.

Can also create asynchronous functions ourselves

- Consuming a promise
- Chaining then... then... done
- Passing a promise
- Creating a promise
- Storing a promise

---

### Syntax

from [MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)

```js
var promise1 = new Promise(function(resolve, reject) {
  setTimeout(function() {
    resolve('foo');
  }, 300);
});

promise1.then(function(value) {
  console.log(value);
  // expected output: "foo"
});

console.log(promise1);
// expected output: [object Promise]
```

---

### Demo 1

[Link](./demo/6-demo-promises.html)

![promises](../images/promises-full.png)

**Long Sync Task**

Runs a while loop for 3 seconds.  Synchronous - can't do anything until complete.  ZERO concurrency

![p1](../images/promises-ex-1.png)

**Long Async (no Promise)**

Implemented using `setInterval` which immediately returns but maybe that's not what you want as it will continue onto the next piece of code (maybe too soon)

Progress bar finished which is not representing a true state of the process

![p2](../images/promise2.png)

3rd option doesn't actually work properly due to set up of code in the source demo - will try to fix manually

---

### Demo 2 - uses

[Link](./demo/6-demo-promises-uses.html)

![uses](../images/prom-uses.png)

**Consuming a promise**

![uses](../images/prom-uses-1.png)

**Passing on a promise**

![uses](../images/prom-uses-2.png)

**Creating a promise**

![uses](../images/prom-uses-3.png)

**Storing a promise**

![uses](../images/prom-uses-4.png)

---

### Reporting progress



---


---

## Web worker



---

## Web sockets



---

## Architecture Patterns



---

## TypeScript



---

## Example questions

[Module 6](./example-questions/6-example-questions.pdf)
